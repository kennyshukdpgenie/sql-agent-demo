version: "3.8"

services:
  n8n:
    image: n8n-with-mysql-client
    # image: docker.n8n.io/n8nio/n8n:latest
    ports:
      - "5678:5678"
    restart: unless-stopped
    # network_mode: "host"  # 👈 USE HOST NETWORK
    environment:
      - TZ=Asia/Shanghai
      - GENERIC_TIMEZONE=Asia/Shanghai
      - N8N_BASIC_AUTH_ACTIVE=true
      - N8N_BASIC_AUTH_USER=admin
      - N8N_BASIC_AUTH_PASSWORD=securepassword
      - N8N_SECURE_COOKIE=false
      # - N8N_ENFORCE_SETTINGS_FILE_PERMISSIONS=true
      # - N8N_RUNNERS_ENABLED=true  
      # - N8N_HOST=0.0.0.0
      # - N8N_PORT=5678
      # - DB_TYPE=mysql
      # - DB_MYSQLDB_HOST=127.0.0.1
      # - DB_MYSQLDB_PORT=3306
      # - DB_MYSQLDB_DATABASE=finance_demo
      # - DB_MYSQLDB_USER=n8n
      # - DB_MYSQLDB_PASSWORD=n8n_password
    volumes:
      - ./n8n_data:/home/node/.n8n


# version: "3.8"

# services:
#   n8n:
#     image: n8nio/n8n:1.81.0
#     restart: unless-stopped
#     ports:
#       - "5678:5678"
#     environment:
#       - DB_TYPE=mysqldb
#       - DB_MYSQLDB_HOST=172.17.0.1      # ✅ 确保这个是能 ping 通的 MySQL 地址
#       - DB_MYSQLDB_PORT=3306
#       - DB_MYSQLDB_DATABASE=n8n         # ✅ 替换为你的数据库名
#       - DB_MYSQLDB_USER=n8n             # ✅ 替换为你的用户名
#       - DB_MYSQLDB_PASSWORD=yourpassword  # ✅ 替换为你设置的密码
#       - N8N_BASIC_AUTH_ACTIVE=true
#       - N8N_BASIC_AUTH_USER=admin       # ✅ 自己设的，不需要注册
#       - N8N_BASIC_AUTH_PASSWORD=admin123
#       - N8N_HOST=0.0.0.0
#       - N8N_PORT=5678
#       - WEBHOOK_TUNNEL_URL=http://localhost:5678
#       - TZ=Asia/Shanghai
#       - GENERIC_TIMEZONE=Asia/Shanghai
#     volumes:
#       - ./n8n_data:/home/node/.n8n


# version: "3.8"

# services:
#   n8n:
#     build:
#       context: .
#       dockerfile: Dockerfile
#     ports:
#       - "5678:5678"
#     volumes:
#       - ~/.n8n:/home/node/.n8n
#     restart: always